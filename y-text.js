!function t(e,n,r){function i(s,l){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!l&&u)return u(s,!0);if(o)return o(s,!0);var a=new Error("Cannot find module '"+s+"'");throw a.code="MODULE_NOT_FOUND",a}var c=n[s]={exports:{}};e[s][0].call(c.exports,function(t){var n=e[s][1][t];return i(n?n:t)},c,c.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){function r(t,e,n){if(t==e)return t?[[p,t]]:[];(0>n||t.length<n)&&(n=null);var r=l(t,e),o=t.substring(0,r);t=t.substring(r),e=e.substring(r),r=u(t,e);var s=t.substring(t.length-r);t=t.substring(0,t.length-r),e=e.substring(0,e.length-r);var a=i(t,e);return o&&a.unshift([p,o]),s&&a.push([p,s]),c(a),null!=n&&(a=h(a,n)),a}function i(t,e){var n;if(!t)return[[d,e]];if(!e)return[[v,t]];var i=t.length>e.length?t:e,s=t.length>e.length?e:t,l=i.indexOf(s);if(-1!=l)return n=[[d,i.substring(0,l)],[p,s],[d,i.substring(l+s.length)]],t.length>e.length&&(n[0][0]=n[2][0]=v),n;if(1==s.length)return[[v,t],[d,e]];var u=a(t,e);if(u){var c=u[0],f=u[1],h=u[2],g=u[3],b=u[4],y=r(c,h),m=r(f,g);return y.concat([[p,b]],m)}return o(t,e)}function o(t,e){for(var n=t.length,r=e.length,i=Math.ceil((n+r)/2),o=i,l=2*i,u=new Array(l),a=new Array(l),c=0;l>c;c++)u[c]=-1,a[c]=-1;u[o+1]=0,a[o+1]=0;for(var f=n-r,h=f%2!=0,g=0,p=0,b=0,y=0,m=0;i>m;m++){for(var x=-m+g;m-p>=x;x+=2){var w,k=o+x;w=x==-m||x!=m&&u[k-1]<u[k+1]?u[k+1]:u[k-1]+1;for(var S=w-x;n>w&&r>S&&t.charAt(w)==e.charAt(S);)w++,S++;if(u[k]=w,w>n)p+=2;else if(S>r)g+=2;else if(h){var O=o+f-x;if(O>=0&&l>O&&-1!=a[O]){var T=n-a[O];if(w>=T)return s(t,e,w,S)}}}for(var _=-m+b;m-y>=_;_+=2){var T,O=o+_;T=_==-m||_!=m&&a[O-1]<a[O+1]?a[O+1]:a[O-1]+1;for(var A=T-_;n>T&&r>A&&t.charAt(n-T-1)==e.charAt(r-A-1);)T++,A++;if(a[O]=T,T>n)y+=2;else if(A>r)b+=2;else if(!h){var k=o+f-_;if(k>=0&&l>k&&-1!=u[k]){var w=u[k],S=o+w-k;if(T=n-T,w>=T)return s(t,e,w,S)}}}}return[[v,t],[d,e]]}function s(t,e,n,i){var o=t.substring(0,n),s=e.substring(0,i),l=t.substring(n),u=e.substring(i),a=r(o,s),c=r(l,u);return a.concat(c)}function l(t,e){if(!t||!e||t.charAt(0)!=e.charAt(0))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;i>n;)t.substring(o,i)==e.substring(o,i)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function u(t,e){if(!t||!e||t.charAt(t.length-1)!=e.charAt(e.length-1))return 0;for(var n=0,r=Math.min(t.length,e.length),i=r,o=0;i>n;)t.substring(t.length-i,t.length-o)==e.substring(e.length-i,e.length-o)?(n=i,o=n):r=i,i=Math.floor((r-n)/2+n);return i}function a(t,e){function n(t,e,n){for(var r,i,o,s,a=t.substring(n,n+Math.floor(t.length/4)),c=-1,f="";-1!=(c=e.indexOf(a,c+1));){var h=l(t.substring(n),e.substring(c)),g=u(t.substring(0,n),e.substring(0,c));f.length<g+h&&(f=e.substring(c-g,c)+e.substring(c,c+h),r=t.substring(0,n-g),i=t.substring(n+h),o=e.substring(0,c-g),s=e.substring(c+h))}return 2*f.length>=t.length?[r,i,o,s,f]:null}var r=t.length>e.length?t:e,i=t.length>e.length?e:t;if(r.length<4||2*i.length<r.length)return null;var o,s=n(r,i,Math.ceil(r.length/4)),a=n(r,i,Math.ceil(r.length/2));if(!s&&!a)return null;o=a?s&&s[4].length>a[4].length?s:a:s;var c,f,h,g;t.length>e.length?(c=o[0],f=o[1],h=o[2],g=o[3]):(h=o[0],g=o[1],c=o[2],f=o[3]);var v=o[4];return[c,f,h,g,v]}function c(t){t.push([p,""]);for(var e,n=0,r=0,i=0,o="",s="";n<t.length;)switch(t[n][0]){case d:i++,s+=t[n][1],n++;break;case v:r++,o+=t[n][1],n++;break;case p:r+i>1?(0!==r&&0!==i&&(e=l(s,o),0!==e&&(n-r-i>0&&t[n-r-i-1][0]==p?t[n-r-i-1][1]+=s.substring(0,e):(t.splice(0,0,[p,s.substring(0,e)]),n++),s=s.substring(e),o=o.substring(e)),e=u(s,o),0!==e&&(t[n][1]=s.substring(s.length-e)+t[n][1],s=s.substring(0,s.length-e),o=o.substring(0,o.length-e))),0===r?t.splice(n-i,r+i,[d,s]):0===i?t.splice(n-r,r+i,[v,o]):t.splice(n-r-i,r+i,[v,o],[d,s]),n=n-r-i+(r?1:0)+(i?1:0)+1):0!==n&&t[n-1][0]==p?(t[n-1][1]+=t[n][1],t.splice(n,1)):n++,i=0,r=0,o="",s=""}""===t[t.length-1][1]&&t.pop();var a=!1;for(n=1;n<t.length-1;)t[n-1][0]==p&&t[n+1][0]==p&&(t[n][1].substring(t[n][1].length-t[n-1][1].length)==t[n-1][1]?(t[n][1]=t[n-1][1]+t[n][1].substring(0,t[n][1].length-t[n-1][1].length),t[n+1][1]=t[n-1][1]+t[n+1][1],t.splice(n-1,1),a=!0):t[n][1].substring(0,t[n+1][1].length)==t[n+1][1]&&(t[n-1][1]+=t[n+1][1],t[n][1]=t[n][1].substring(t[n+1][1].length)+t[n+1][1],t.splice(n+1,1),a=!0)),n++;a&&c(t)}function f(t,e){if(0===e)return[p,t];for(var n=0,r=0;r<t.length;r++){var i=t[r];if(i[0]===v||i[0]===p){var o=n+i[1].length;if(e===o)return[r+1,t];if(o>e){t=t.slice();var s=e-n,l=[i[0],i[1].slice(0,s)],u=[i[0],i[1].slice(s)];return t.splice(r,1,l,u),[r+1,t]}n=o}}throw new Error("cursor_pos is out of bounds!")}function h(t,e){var n=f(t,e),r=n[1],i=n[0],o=r[i],s=r[i+1];if(null==o)return t;if(o[0]!==p)return t;if(null!=s&&o[1]+s[1]===s[1]+o[1])return r.splice(i,2,s,o),g(r,i,2);if(null!=s&&0===s[1].indexOf(o[1])){r.splice(i,2,[s[0],o[1]],[0,o[1]]);var l=s[1].slice(o[1].length);return l.length>0&&r.splice(i+2,0,[s[0],l]),g(r,i,3)}return t}function g(t,e,n){for(var r=e+n-1;r>=0&&r>=e-1;r--)if(r+1<t.length){var i=t[r],o=t[r+1];i[0]===o[1]&&t.splice(r,2,[i[0],i[1]+o[1]])}return t}var v=-1,d=1,p=0,b=r;b.INSERT=d,b.DELETE=v,b.EQUAL=p,e.exports=b},{}],2:[function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t){t.requestModules(["Array"]).then(function(){var e=function(t){function e(t,n,o){r(this,e);var s=i(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n,o));return s.textfields=[],s.aceInstances=[],s}return o(e,t),u(e,[{key:"toString",value:function(){return this._content.map(function(t){return t.val}).join("")}},{key:"insert",value:function(t,n){a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"insert",this).call(this,t,n.split(""))}},{key:"unbindAll",value:function(){for(var t=this.textfields.length-1;t>=0;t--)this.unbindTextarea(this.textfields[t].editor);for(var e=this.aceInstances.length-1;e>=0;e--)this.unbindAce(this.aceInstances[e].editor)}},{key:"unbindAce",value:function(t){var e=this.aceInstances.findIndex(function(e){return e.editor===t});if(e>=0){var n=this.aceInstances[e];this.unobserve(n.yCallback),n.editor.off("change",n.aceCallback),this.aceInstances.splice(e,1)}}},{key:"bindAce",value:function(t,e){function n(t){if(u){u=!1;try{t()}catch(e){throw u=!0,new Error(e)}u=!0}}function r(e){n(function(){var n=0,r=0,i=t.getSession().getDocument();"insert"===e.action?(n=i.positionToIndex(e.start,0),s.insert(n,e.lines.join("\n"))):"remove"===e.action&&(n=i.positionToIndex(e.start,0),r=e.lines.join("\n").length,s["delete"](n,r))})}function i(e,n,r){if(!a){var i=0;e.row===n.row&&e.column===n.column&&(i=1);var o=new c(e.row,e.column,n.row,n.column+i),s=t.session.addMarker(o,r,"text");t.markers.push({id:s,timestamp:Date.now()})}}function o(e){var r=t.getSession().getDocument();n(function(){if("insert"===e.type){var t=r.indexToPosition(e.index,0),n=r.indexToPosition(e.index+e.length,0);r.insert(t,e.values.join("")),i(t,n,"inserted")}else if("delete"===e.type){var o=r.indexToPosition(e.index,0),s=r.indexToPosition(e.index+e.length,0),l=new c(o.row,o.column,s.row,s.column);r.remove(l),i(o,s,"deleted")}})}var s=this,u=!0;t.markers=[];var a=!1;"object"===("undefined"==typeof e?"undefined":l(e))&&"undefined"!=typeof e.disableMarkers&&(a=e.disableMarkers),t.setValue(this.toString()),t.on("change",r),a||(this.inteval&&clearInterval(this.inteval),this.inteval=setInterval(function(){for(var e=0,n=Date.now(),r=800;e<t.markers.length;){var i=t.markers[e];i.timestamp+r<n&&(t.getSession().removeMarker(i.id),t.markers.splice(e,1),e--),e++}},1e3));var c=window.ace.require("ace/range").Range;this.observe(o),this.aceInstances.push({editor:t,yCallback:o,aceCallback:r})}},{key:"bind",value:function(){var t=arguments[0];t instanceof Element?this.bindTextarea.apply(this,arguments):null!=t&&null!=t.session&&null!=t.getSession&&null!=t.setValue?this.bindAce.apply(this,arguments):console.error("Cannot bind, unsupported editor!")}},{key:"unbindTextarea",value:function(t){var e=this.textfields.findIndex(function(e){return e.editor===t});if(e>=0){var n=this.textfields[e];this.unobserve(n.yCallback);var r=n.editor;r.removeEventListener("input",n.eventListener),this.textfields.splice(e,1)}}},{key:"bindTextarea",value:function(t,e){function n(t){if(o){o=!1;try{t()}catch(e){throw o=!0,new Error(e)}o=!0}}function r(t){n(function(){var e,n;if("insert"===t.type){e=t.index,n=function(t){return e>=t?t:t+=1};var r=l(n);u(r)}else"delete"===t.type&&(e=t.index,n=function(t){return e>t?t:t-=1},r=l(n),u(r))})}e=e||window,null==e.getSelection&&(e=window);for(var i=0;i<this.textfields.length;i++)if(this.textfields[i].editor===t)return;var o=!0,s=this;t.value=this.toString();var l,u,a,f;null!=t.selectionStart&&null!=t.setSelectionRange?(l=function(e){var n=t.selectionStart,r=t.selectionEnd;return null!=e&&(n=e(n),r=e(r)),{left:n,right:r}},u=function(e){a(s.toString()),t.setSelectionRange(e.left,e.right)},a=function(e){t.value=e},f=function(){return t.value}):(l=function(n){var r={},i=e.getSelection(),o=t.textContent.length;r.left=Math.min(i.anchorOffset,o),r.right=Math.min(i.focusOffset,o),null!=n&&(r.left=n(r.left),r.right=n(r.right));var s=i.focusNode;return s===t||s===t.childNodes[0]?r.isReal=!0:r.isReal=!1,r},u=function(n){a(s.toString());var r=t.childNodes[0];if(n.isReal&&null!=r){n.left<0&&(n.left=0),n.right=Math.max(n.left,n.right),n.right>r.length&&(n.right=r.length),n.left=Math.min(n.left,n.right);var i=document.createRange();i.setStart(r,n.left),i.setEnd(r,n.right);var o=e.getSelection();o.removeAllRanges(),o.addRange(i)}},a=function(e){t.innerText=e},f=function(){return t.innerText}),a(this.toString()),this.observe(r);var h=function(){n(function(){for(var t=l(function(t){return t}),e=s.toString(),n=f(),r=c(e,n,t.left),i=0,o=0;o<r.length;o++){var u=r[o];0===u[0]?i+=u[1].length:-1===u[0]?s["delete"](i,u[1].length):(s.insert(i,u[1]),i+=u[1].length)}})};t.addEventListener("input",h),this.textfields.push({editor:t,yCallback:r,eventListener:h})}},{key:"_destroy",value:function(){this.unbindAll(),this.textfields=null,this.aceInstances=null,a(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_destroy",this).call(this)}}]),e}(t.Array.typeDefinition["class"]);t.extend("Text",new t.utils.CustomTypeDefinition({name:"Text","class":e,struct:"List",initType:regeneratorRuntime.mark(function n(r,i){var o;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return o=[],n.delegateYield(t.Struct.List.map.call(this,i,function(t){if(t.hasOwnProperty("opContent"))throw new Error("Text must not contain types!");t.content.forEach(function(e,n){o.push({id:[t.id[0],t.id[1]+n],val:t.content[n]})})}),"t0",2);case 2:return n.abrupt("return",new e(r,i.id,o));case 3:case"end":return n.stop()}},n,this)}),createType:function(t,n){return new e(t,n.id,[])}}))})}var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},u=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function f(t,e,n){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,e);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:f(i,e,n)}if("value"in r)return r.value;var o=r.get;return void 0===o?void 0:o.call(n)},c=t("fast-diff");e.exports=s,"undefined"!=typeof Y&&s(Y)},{"fast-diff":1}]},{},[2]);
//# sourceMappingURL=y-text.js.map
