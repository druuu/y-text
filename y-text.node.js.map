{"version":3,"file":"y-text.node.js","sources":["src/y-text.js"],"sourcesContent":["/* global Y, Element */\n\nimport diff from 'fast-diff'\n\nvar monacoIdentifierTemplate = { major: 0, minor: 0 }\n\nexport default function extendYText (Y) {\n  Y.requestModules(['Array']).then(function () {\n    class YText extends Y.Array.typeDefinition['class'] {\n      constructor (os, _model, _content, args) {\n        super(os, _model, _content)\n        this.textfields = []\n        this.aceInstances = []\n        this.codeMirrorInstances = []\n        this.monacoInstances = []\n        if (args != null && _model[0] !== '_' && typeof args === 'string') {\n          this.insert(0, args)\n        }\n      }\n      toString () {\n        return this._content.map(function (c) {\n          return c.val\n        }).join('')\n      }\n      toJSON () {\n        return this.toString()\n      }\n      insert (pos, content) {\n        var arr = content.split('')\n        for (var i = 0; i < arr.length; i++) {\n          if (/[\\uD800-\\uDFFF]/.test(arr[i])) {\n            // is surrogate pair\n            arr[i] = arr[i] + arr[i + 1]\n            arr[i + 1] = ''\n            i++\n          }\n        }\n        super.insert(pos, arr)\n      }\n      delete (pos, length) {\n        if (length == null) { length = 1 }\n        if (typeof length !== 'number') {\n          throw new Error('length must be a number!')\n        }\n        if (typeof pos !== 'number') {\n          throw new Error('pos must be a number!')\n        }\n        if (pos + length > this._content.length || pos < 0 || length < 0) {\n          throw new Error('The deletion range exceeds the range of the array!')\n        }\n        if (length === 0) {\n          return\n        }\n        // This is for the case that part of a surrogate pair is deleted\n        // we store surrogate pairs like this: [.., '🐇', '', ..] (string, code)\n        if (this._content.length > pos + length && this._content[pos + length].val === '' && this._content[pos + length - 1].val.length === 2) {\n          // case one. first part of the surrogate pair is deleted\n          let token = this._content[pos + length - 1].val[0]\n          super.delete(pos, length + 1)\n          super.insert(pos, [token])\n        } else if (pos > 0 && this._content[pos].val === '' && this._content[pos - 1].val.length === 2) {\n          // case two. second part of the surrogate pair is deleted\n          let token = this._content[pos - 1].val[1]\n          super.delete(pos - 1, length + 1)\n          super.insert(pos - 1, [token])\n        } else {\n          super.delete(pos, length)\n        }\n      }\n      unbindAll () {\n        this.unbindTextareaAll()\n        this.unbindAceAll()\n        this.unbindCodeMirrorAll()\n        this.unbindMonacoAll()\n      }\n      // Monaco implementation\n      unbindMonaco (monacoInstance) {\n        var i = this.monacoInstances.findIndex(function (binding) {\n          return binding.editor === monacoInstance\n        })\n        if (i >= 0) {\n          var binding = this.monacoInstances[i]\n          this.unobserve(binding.yCallback)\n          binding.disposeBinding()\n          this.monacoInstances.splice(i, 1)\n        }\n      }\n      unbindMonacoAll () {\n        for (let i = this.monacoInstances.length - 1; i >= 0; i--) {\n          this.unbindMonaco(this.monacoInstances[i].editor)\n        }\n      }\n      bindMonaco (monacoInstance, options) {\n        var self = this\n        options = options || {}\n\n        // this function makes sure that either the\n        // monaco event is executed, or the yjs observer is executed\n        var token = true\n        function mutualExcluse (f) {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              token = true\n              throw new Error(e)\n            }\n            token = true\n          }\n        }\n        monacoInstance.setValue(this.toString())\n\n        function monacoCallback (event) {\n          mutualExcluse(function () {\n            // compute start.. (col+row -> index position)\n            // We shouldn't compute the offset on the old model..\n            //    var start = monacoInstance.model.getOffsetAt({column: event.range.startColumn, lineNumber: event.range.startLineNumber})\n            // So we compute the offset using the _content of this type\n            for (var i = 0, line = 1; line < event.range.startLineNumber; i++) {\n              if (self._content[i].val === '\\n') {\n                line++\n              }\n            }\n            var start = i + event.range.startColumn - 1\n\n            // apply the delete operation first\n            if (event.rangeLength > 0) {\n              self.delete(start, event.rangeLength)\n            }\n            // apply insert operation\n            self.insert(start, event.text)\n          })\n        }\n        var disposeBinding = monacoInstance.onDidChangeModelContent(monacoCallback).dispose\n\n        function yCallback (event) {\n          mutualExcluse(function () {\n            let start = monacoInstance.model.getPositionAt(event.index)\n            var end, text\n            if (event.type === 'insert') {\n              end = start\n              text = event.values.join('')\n            } else if (event.type === 'delete') {\n              end = monacoInstance.model.modifyPosition(start, event.length)\n              text = ''\n            }\n            var range = {\n              startLineNumber: start.lineNumber,\n              startColumn: start.column,\n              endLineNumber: end.lineNumber,\n              endColumn: end.column\n            }\n            var id = {\n              major: monacoIdentifierTemplate.major,\n              minor: monacoIdentifierTemplate.minor++\n            }\n            monacoInstance.executeEdits('Yjs', [{\n              id: id,\n              range: range,\n              text: text,\n              forceMoveMarkers: true\n            }])\n          })\n        }\n        this.observe(yCallback)\n        this.monacoInstances.push({\n          editor: monacoInstance,\n          yCallback: yCallback,\n          monacoCallback: monacoCallback,\n          disposeBinding: disposeBinding\n        })\n      }\n      // CodeMirror implementation..\n      unbindCodeMirror (codeMirrorInstance) {\n        var i = this.codeMirrorInstances.findIndex(function (binding) {\n          return binding.editor === codeMirrorInstance\n        })\n        if (i >= 0) {\n          var binding = this.codeMirrorInstances[i]\n          this.unobserve(binding.yCallback)\n          binding.editor.off('changes', binding.codeMirrorCallback)\n          this.codeMirrorInstances.splice(i, 1)\n        }\n      }\n      unbindCodeMirrorAll () {\n        for (let i = this.codeMirrorInstances.length - 1; i >= 0; i--) {\n          this.unbindCodeMirror(this.codeMirrorInstances[i].editor)\n        }\n      }\n      bindCodeMirror (codeMirrorInstance, options) {\n        var self = this\n        options = options || {}\n\n        // this function makes sure that either the\n        // codemirror event is executed, or the yjs observer is executed\n        var token = true\n        function mutualExcluse (f) {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              token = true\n              throw new Error(e)\n            }\n            token = true\n          }\n        }\n        codeMirrorInstance.setValue(this.toString())\n\n        function codeMirrorCallback (cm, deltas) {\n          mutualExcluse(function () {\n            for (var i = 0; i < deltas.length; i++) {\n              var delta = deltas[i]\n              var start = codeMirrorInstance.indexFromPos(delta.from)\n              // apply the delete operation first\n              if (delta.removed.length > 0) {\n                var delLength = 0\n                for (var j = 0; j < delta.removed.length; j++) {\n                  delLength += delta.removed[j].length\n                }\n                // \"enter\" is also a character in our case\n                delLength += delta.removed.length - 1\n                self.delete(start, delLength)\n              }\n              // apply insert operation\n              self.insert(start, delta.text.join('\\n'))\n            }\n          })\n        }\n        codeMirrorInstance.on('changes', codeMirrorCallback)\n\n        function yCallback (event) {\n          mutualExcluse(function () {\n            let from = codeMirrorInstance.posFromIndex(event.index)\n            if (event.type === 'insert') {\n              let to = from\n              codeMirrorInstance.replaceRange(event.values.join(''), from, to)\n            } else if (event.type === 'delete') {\n              let to = codeMirrorInstance.posFromIndex(event.index + event.length)\n              codeMirrorInstance.replaceRange('', from, to)\n            }\n          })\n        }\n        this.observe(yCallback)\n        this.codeMirrorInstances.push({\n          editor: codeMirrorInstance,\n          yCallback: yCallback,\n          codeMirrorCallback: codeMirrorCallback\n        })\n      }\n      unbindAce (aceInstance) {\n        var i = this.aceInstances.findIndex(function (binding) {\n          return binding.editor === aceInstance\n        })\n        if (i >= 0) {\n          var binding = this.aceInstances[i]\n          this.unobserve(binding.yCallback)\n          binding.editor.off('change', binding.aceCallback)\n          this.aceInstances.splice(i, 1)\n        }\n      }\n      unbindAceAll () {\n        for (let i = this.aceInstances.length - 1; i >= 0; i--) {\n          this.unbindAce(this.aceInstances[i].editor)\n        }\n      }\n      bindAce (aceInstance, options) {\n        var self = this\n        options = options || {}\n\n        // this function makes sure that either the\n        // ace event is executed, or the yjs observer is executed\n        var token = true\n        function mutualExcluse (f) {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              token = true\n              throw new Error(e)\n            }\n            token = true\n          }\n        }\n        aceInstance.setValue(this.toString())\n\n        function aceCallback (delta) {\n          mutualExcluse(function () {\n            var start\n            var length\n\n            var aceDocument = aceInstance.getSession().getDocument()\n            if (delta.action === 'insert') {\n              start = aceDocument.positionToIndex(delta.start, 0)\n              self.insert(start, delta.lines.join('\\n'))\n            } else if (delta.action === 'remove') {\n              start = aceDocument.positionToIndex(delta.start, 0)\n              length = delta.lines.join('\\n').length\n              self.delete(start, length)\n            }\n          })\n        }\n        aceInstance.on('change', aceCallback)\n\n        aceInstance.selection.clearSelection()\n\n        // We don't that ace is a global variable\n        // see #2\n        var aceClass\n        if (typeof ace !== 'undefined' && options.aceClass == null) {\n          aceClass = ace // eslint-disable-line\n        } else {\n          aceClass = options.aceClass\n        }\n        var aceRequire = options.aceRequire || aceClass.require\n        var Range = aceRequire('ace/range').Range\n\n        function yCallback (event) {\n          var aceDocument = aceInstance.getSession().getDocument()\n          mutualExcluse(function () {\n            if (event.type === 'insert') {\n              let start = aceDocument.indexToPosition(event.index, 0)\n              aceDocument.insert(start, event.values.join(''))\n            } else if (event.type === 'delete') {\n              let start = aceDocument.indexToPosition(event.index, 0)\n              let end = aceDocument.indexToPosition(event.index + event.length, 0)\n              var range = new Range(start.row, start.column, end.row, end.column)\n              aceDocument.remove(range)\n            }\n          })\n        }\n        this.observe(yCallback)\n        this.aceInstances.push({\n          editor: aceInstance,\n          yCallback: yCallback,\n          aceCallback: aceCallback\n        })\n      }\n      bind () {\n        var e = arguments[0]\n        if (e instanceof Element) {\n          this.bindTextarea.apply(this, arguments)\n        } else if (e != null && e.session != null && e.getSession != null && e.setValue != null) {\n          this.bindAce.apply(this, arguments)\n        } else if (e != null && e.posFromIndex != null && e.replaceRange != null) {\n          this.bindCodeMirror.apply(this, arguments)\n        } else if (e != null && e.onDidChangeModelContent != null) {\n          this.bindMonaco.apply(this, arguments)\n        } else {\n          console.error('Cannot bind, unsupported editor!')\n        }\n      }\n      unbindTextarea (textarea) {\n        var i = this.textfields.findIndex(function (binding) {\n          return binding.editor === textarea\n        })\n        if (i >= 0) {\n          var binding = this.textfields[i]\n          this.unobserve(binding.yCallback)\n          var e = binding.editor\n          e.removeEventListener('input', binding.eventListener)\n          this.textfields.splice(i, 1)\n        }\n      }\n      unbindTextareaAll () {\n        for (let i = this.textfields.length - 1; i >= 0; i--) {\n          this.unbindTextarea(this.textfields[i].editor)\n        }\n      }\n      bindTextarea (textfield, domRoot) {\n        domRoot = domRoot || window; // eslint-disable-line\n        if (domRoot.getSelection == null) {\n          domRoot = window; // eslint-disable-line\n        }\n\n        // don't duplicate!\n        for (var t = 0; t < this.textfields.length; t++) {\n          if (this.textfields[t].editor === textfield) {\n            return\n          }\n        }\n        // this function makes sure that either the\n        // textfieldt event is executed, or the yjs observer is executed\n        var token = true\n        function mutualExcluse (f) {\n          if (token) {\n            token = false\n            try {\n              f()\n            } catch (e) {\n              token = true\n              throw new Error(e)\n            }\n            token = true\n          }\n        }\n\n        var self = this\n        textfield.value = this.toString()\n\n        var createRange, writeRange, writeContent, getContent\n        if (textfield.selectionStart != null && textfield.setSelectionRange != null) {\n          createRange = function (fix) {\n            var left = textfield.selectionStart\n            var right = textfield.selectionEnd\n            if (fix != null) {\n              left = fix(left)\n              right = fix(right)\n            }\n            return {\n              left: left,\n              right: right\n            }\n          }\n          writeRange = function (range) {\n            writeContent(self.toString())\n            textfield.setSelectionRange(range.left, range.right)\n          }\n          writeContent = function (content) {\n            textfield.value = content\n          }\n          getContent = function () {\n            return textfield.value\n          }\n        } else {\n          createRange = function (fix) {\n            var range = {}\n            var s = domRoot.getSelection()\n            var clength = textfield.textContent.length\n            range.left = Math.min(s.anchorOffset, clength)\n            range.right = Math.min(s.focusOffset, clength)\n            if (fix != null) {\n              range.left = fix(range.left)\n              range.right = fix(range.right)\n            }\n            var editedElement = s.focusNode\n            if (editedElement === textfield || editedElement === textfield.childNodes[0]) {\n              range.isReal = true\n            } else {\n              range.isReal = false\n            }\n            return range\n          }\n\n          writeRange = function (range) {\n            writeContent(self.toString())\n            var textnode = textfield.childNodes[0]\n            if (range.isReal && textnode != null) {\n              if (range.left < 0) {\n                range.left = 0\n              }\n              range.right = Math.max(range.left, range.right)\n              if (range.right > textnode.length) {\n                range.right = textnode.length\n              }\n              range.left = Math.min(range.left, range.right)\n              var r = document.createRange(); // eslint-disable-line\n              r.setStart(textnode, range.left)\n              r.setEnd(textnode, range.right)\n              var s = domRoot.getSelection(); // eslint-disable-line\n              s.removeAllRanges()\n              s.addRange(r)\n            }\n          }\n          writeContent = function (content) {\n            textfield.innerText = content\n            /*\n            var contentArray = content.replace(new RegExp('\\n', 'g'), ' ').split(' '); // eslint-disable-line\n            textfield.innerText = ''\n            for (var i = 0; i < contentArray.length; i++) {\n              var c = contentArray[i]\n              textfield.innerText += c\n              if (i !== contentArray.length - 1) {\n                textfield.innerHTML += '&nbsp;'\n              }\n            }\n            */\n          }\n          getContent = function () {\n            return textfield.innerText\n          }\n        }\n        writeContent(this.toString())\n\n        function yCallback (event) {\n          mutualExcluse(() => {\n            var oPos, fix\n            if (event.type === 'insert') {\n              oPos = event.index\n              fix = function (cursor) { // eslint-disable-line\n                if (cursor <= oPos) {\n                  return cursor\n                } else {\n                  cursor += 1\n                  return cursor\n                }\n              }\n              var r = createRange(fix)\n              writeRange(r)\n            } else if (event.type === 'delete') {\n              oPos = event.index\n              fix = function (cursor) { // eslint-disable-line\n                if (cursor < oPos) {\n                  return cursor\n                } else {\n                  cursor -= 1\n                  return cursor\n                }\n              }\n              r = createRange(fix)\n              writeRange(r)\n            }\n          })\n        }\n        this.observe(yCallback)\n\n        var textfieldObserver = function textfieldObserver () {\n          mutualExcluse(function () {\n            var r = createRange(function (x) { return x })\n            var oldContent = self.toString()\n            var content = getContent()\n            var diffs = diff(oldContent, content, r.left)\n            var pos = 0\n            for (var i = 0; i < diffs.length; i++) {\n              var d = diffs[i]\n              if (d[0] === 0) { // EQUAL\n                pos += d[1].length\n              } else if (d[0] === -1) { // DELETE\n                self.delete(pos, d[1].length)\n              } else { // INSERT\n                self.insert(pos, d[1])\n                pos += d[1].length\n              }\n            }\n          })\n        }\n        textfield.addEventListener('input', textfieldObserver)\n        this.textfields.push({\n          editor: textfield,\n          yCallback: yCallback,\n          eventListener: textfieldObserver\n        })\n      }\n      _destroy () {\n        this.unbindAll()\n        this.textfields = null\n        this.aceInstances = null\n        super._destroy()\n      }\n    }\n    Y.extend('Text', new Y.utils.CustomTypeDefinition({\n      name: 'Text',\n      class: YText,\n      struct: 'List',\n      parseArguments: function (arg) {\n        if (typeof arg === 'string') {\n          return [this, arg]\n        } else {\n          return [this, null]\n        }\n      },\n      initType: function YTextInitializer (os, model) {\n        var _content = []\n        Y.Struct.List.map.call(this, model, function (op) {\n          if (op.hasOwnProperty('opContent')) {\n            throw new Error('Text must not contain types!')\n          } else {\n            op.content.forEach(function (c, i) {\n              _content.push({\n                id: [op.id[0], op.id[1] + i],\n                val: op.content[i]\n              })\n            })\n          }\n        })\n        return new YText(os, model.id, _content)\n      },\n      createType: function YTextCreator (os, model, args) {\n        return new YText(os, model.id, [], args)\n      }\n    }))\n  })\n}\n\nif (typeof Y !== 'undefined') {\n  extendYText(Y)\n}\n"],"names":[],"mappings":"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"}